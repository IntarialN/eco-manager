# Автоархивация неактивных чатов

**Контекст**
- Требование: если в чате нет ответов ≥30 минут, он должен сохраняться как история и активироваться при следующем сообщении.

**Что сделано**
1. Добавлен консольный контроллер `yii-app/commands/ChatMaintenanceController.php` с командой `php yii chat-maintenance/archive --timeout=30`. Она переводит все сессии без активности старше таймаута в статус `closed`.
2. `ChatService::postMessage()` уже возвращает статус `open`, поэтому новое сообщение автоматически «оживляет» чат и продолжает историю.
3. Runbook обновлён (раздел 8) — описал запуск cron/команды.
4. `docs/features/chat-support.md` дополнён сведениями об автоархивации.

**Дальнейшие шаги**
- Настроить cron (или GitHub Actions) для периодического запуска команды.
- После внедрения realtime-канала генерировать события об архивировании, чтобы операторский UI обновлялся моментально.
