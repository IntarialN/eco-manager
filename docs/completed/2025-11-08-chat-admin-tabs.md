# Вкладки «Мои/Открытые/Закрытые» и непрочитанные в чатах

**Контекст**
- Требование: операторы должны видеть свои, свободные и закрытые чаты, получать уведомления только при новых диалогах или сообщениях в своих сессиях.

**Что сделано**
1. Добавлена миграция `m230000_000011_add_chat_seen_fields` + поле `assigned_seen_at` в `ChatSession` для отслеживания непрочитанных.
2. `ChatController` теперь:
   - Возвращает на `/chat/inbox` три выборки (`my/open/closed`), помечает непрочитанные (при открытии `thread` обновляет `assigned_seen_at`).
   - Расширил `chat/alerts`: отдельные флаги `has_new_dialogs` и `has_my_updates`.
3. UI:
   - `views/chat/inbox.php` перерисован на вкладки с таблицами, индикаторами и счётчиком.
   - `layouts/main.php` и `site.css` — два бэджа в навигации (новые и «мои»), подсказки для кнопки, учёт `lastSeen` (localStorage).
4. `ChatService` помечает сообщения оператора как прочитанные (`assigned_seen_at`). При «взять в работу» время тоже фиксируется.
5. Документы: `docs/features/chat-support.md` обновлён; создан лог `docs/completed/2025-11-08-chat-admin-tabs.md`.

**Следующее**
- Перейти на Centrifugo/WebSocket для push-уведомлений (см. `chat-realtime.md`).
- Настроить cron на `php yii chat-maintenance/archive` и добавить уведомления об архивировании в события.
